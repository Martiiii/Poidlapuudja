<!DOCTYPE html>
<html lang="et" manifest="/manifest.appcache">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="../../favicon.ico">
    <base href="<?php echo base_url() ?>">
    <title>Pöidlapüüdja - Toetamine</title>
    <!-- Bootstrap core CSS -->

    <link href="css/bootstrap.css" rel="stylesheet">


    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <link href="css/ie10-viewport-bug-workaround.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="css/cover.css" rel="stylesheet">

    <!-- Just for debugging purposes. Don't actually copy these 2 lines! -->
    <!--[if lt IE 9]
    <script src="js/ie8-responsive-file-warning.js"></script><![endif]-->
    <!-- <script src="js/ie-emulation-modes-warning.js"></script> -->




</head>
<body>
<div class="container">


    <?php



    // THIS IS AUTO GENERATED SCRIPT
    // (c) 2011-2016 Kreata OÜ www.pangalink.net

    // File encoding: UTF-8
    // Check that your editor is set to use UTF-8 before using any non-ascii characters
    $private_key = openssl_pkey_get_private(
        "-----BEGIN RSA PRIVATE KEY-----
MIIEogIBAAKCAQEAoUcVZqbYIFSQzjdcd07pcwEYEtvhN3dunnmlttqdhwq+9AXA
RZDz0DxJpNaSIjkoWQ7yR6W/bb8eeJ/xwJ2uhDYladGAJv0pgUf8xMR3djbC3S9P
UD/NnsB8La348rBtlCntjLvyt6d9RjdU/7SYNxqZVH7WRmtj7kDMef+fkI3+TzkH
GcVnSSCBe+1Q/iDSXlAttKgDKDEo7LVYnkrj9l+3x8VfP22kD4nfa5ZBvuQAfS0m
k4M9t8DOk/d0w0/HEX5MZTNIKtdI1iLjhYbSw8K1e+KKmjf5abwBvJVT6tAtpf4U
O+TMYXWinWCWjWkbMip57qQeX7YQdF9yMYFN9wIDAQABAoIBABgvdMIkGx0eEWkb
XD54EwIwE9AgMTIEMw6I55T4S89IiUJG6oKELkv3/oM9ukRvleFlIGgmLwLiOkuU
kMh13QnupMWtqS4voN3GUd2gKNoNdEN/KMG8D7XS38xp3n9mfchOUVVdihSIhXzW
J2UBTCJXVs8ZBkEhMac1CHTzJJakt46xOfyXZ5o2C8JQXdLpq0xhHSrBvI/1wwe/
KTVXz5yVifxNx0Q1RDKDUMD1kh5Vdn3MX+KEgwvnfQeWdGy8Ta/7xrWNRw7XDCtt
Xyy8255aUljyt7+6O+2NcUHJ4AjgJkD3CRzAB+vKqUH/9xkiaN3m20GWVRIscXUX
OT3PEGECgYEA1UkKXKys+/dgnl6Jq/dngVS/TdLRtKqoAhb1+0gDJm4uqavC9dK9
iR5nPp00gIUYGM5+JxdysoJIvYy9rtvglU0C17WMmU9CgO4nqdx2UGhuad0c3wMZ
/ERQNdk764hcWUCDI9RtBgGpgMjJCIeSajc+smEMTTfbIG06lcWuPI0CgYEAwZOn
nXV/qyWiJB8NlA/NQ4sQ4ug4roLkqJ5399c+VpR00TaVpX3doGry0rUAq/kapxo9
R9KjT0mdwn3PSdUT2+fek5i6rAqfBHtE0j80V43qhayaGY2wLenkRgVxUw7ICiFo
wWtLDxrb8SfPRNnvOoFwss6r9gbJcWUA2p9+7ZMCgYBzxQq31Q6sUdGDBQOrcUYg
gFS6tGUZsMwzHi10sNjs4j+330Ca2EIDDJqz9PbLj/LNfEAjjem3FVrQcHWBVV4p
DD0vwx7HFKufeiXTYJRj/tt34QpLzs4rDRWQtRJ+PW0LESZdq29mJD7SZaohVB1Y
RBZnEqBvxZLOnht/smZp/QKBgBaPdNt/FDAIJMt86wI0jUGv9Xncgq6kBq44Odci
uNsyViMD75DoCGpnzIEOI1PnplmPT1ENlYbqF37RVtVOBhB9B43AIRFn83x8OVsf
jqQdoBWQNi2AO+Y9+iLHA5wgfuPfXOwd6xOJl9SVRSzLEXyKFW5hc90qkVOr59uS
9yINAoGAGRxZcHfifo5kZp8CQBKlfNHQCcSSkZcbAW5dVMvssdYk6VoosCHSEUjy
e2WfTW4cm006iTzPUOo0GBdhafNeEFoEbVQRga0Li8MhkQeaYTIVJet3tvfI0wcL
Cp1SXBdSiS+2wUwPVKwDfg+CxFUtkJxHCkgn6FpGIe5mHGohebU=
-----END RSA PRIVATE KEY-----");


    // STEP 1. Setup private key
    // =========================

    // STEP 2. Define payment information
    // ==================================

    $fields = array(
        "VK_SERVICE" => "1011",
        "VK_VERSION" => "008",
        "VK_SND_ID" => "uid100094",
        "VK_STAMP" => "12345",
        "VK_AMOUNT" => "50",
        "VK_CURR" => "EUR",
        "VK_ACC" => "EE871600161234567892",
        "VK_NAME" => "MTÜ Pöidlapüüdja",
        "VK_REF" => "1234561",
        "VK_LANG" => "EST",
        "VK_MSG" => "Annetus",
        "VK_RETURN" => 'http://www.poial.cs.ut.ee/onnestus',
        "VK_CANCEL" => 'http://www.poial.cs.ut.ee/ebaonnestus',
        "VK_DATETIME" => "2016-04-17T19:11:31+0300",
        "VK_ENCODING" => "utf-8",
    );
    // http://localhost:8080/project/EZX5U64dyWRkvQDf?payment_action=success
    // http://localhost:8080/project/EZX5U64dyWRkvQDf?payment_action=cancel
    // STEP 3. Generate data to be signed
    // ==================================

    // Data to be signed is in the form of XXXYYYYY where XXX is 3 char
    // zero padded length of the value and YYY the value itself
    // NB! Ipizza Testpank expects symbol count, not byte count with UTF-8,
    // so use `mb_strlen` instead of `strlen` to detect the length of a string

    $data = str_pad(mb_strlen($fields["VK_SERVICE"], "UTF-8"), 3, "0", STR_PAD_LEFT) . $fields["VK_SERVICE"] .    /* 1011 */
        str_pad(mb_strlen($fields["VK_VERSION"], "UTF-8"), 3, "0", STR_PAD_LEFT) . $fields["VK_VERSION"] .    /* 008 */
        str_pad(mb_strlen($fields["VK_SND_ID"], "UTF-8"), 3, "0", STR_PAD_LEFT) . $fields["VK_SND_ID"] .     /* uid100065 */
        str_pad(mb_strlen($fields["VK_STAMP"], "UTF-8"), 3, "0", STR_PAD_LEFT) . $fields["VK_STAMP"] .      /* 12345 */
        str_pad(mb_strlen($fields["VK_AMOUNT"], "UTF-8"), 3, "0", STR_PAD_LEFT) . $fields["VK_AMOUNT"] .     /* 150 */
        str_pad(mb_strlen($fields["VK_CURR"], "UTF-8"), 3, "0", STR_PAD_LEFT) . $fields["VK_CURR"] .       /* EUR */
        str_pad(mb_strlen($fields["VK_ACC"], "UTF-8"), 3, "0", STR_PAD_LEFT) . $fields["VK_ACC"] .        /* EE871600161234567892 */
        str_pad(mb_strlen($fields["VK_NAME"], "UTF-8"), 3, "0", STR_PAD_LEFT) . $fields["VK_NAME"] .       /* MTÜ Pöidlapüüdja */
        str_pad(mb_strlen($fields["VK_REF"], "UTF-8"), 3, "0", STR_PAD_LEFT) . $fields["VK_REF"] .        /* 1234561 */
        str_pad(mb_strlen($fields["VK_MSG"], "UTF-8"), 3, "0", STR_PAD_LEFT) . $fields["VK_MSG"] .        /* Torso Tiger */
        str_pad(mb_strlen($fields["VK_RETURN"], "UTF-8"), 3, "0", STR_PAD_LEFT) . $fields["VK_RETURN"] .     /* http://localhost:8080/project/EZX5U64dyWRkvQDf?payment_action=success */
        str_pad(mb_strlen($fields["VK_CANCEL"], "UTF-8"), 3, "0", STR_PAD_LEFT) . $fields["VK_CANCEL"] .     /* http://localhost:8080/project/EZX5U64dyWRkvQDf?payment_action=cancel */
        str_pad(mb_strlen($fields["VK_DATETIME"], "UTF-8"), 3, "0", STR_PAD_LEFT) . $fields["VK_DATETIME"];    /* 2016-04-08T18:51:12+0300 */

    /* $data = "0041011003008009uid10006500512345003150003EUR020EE871600161234567892016MTÜ Pöidlapüüdja0071234561011Torso Tiger069http://localhost:8080/project/EZX5U64dyWRkvQDf?payment_action=success068http://localhost:8080/project/EZX5U64dyWRkvQDf?payment_action=cancel0242016-04-08T18:51:12+0300"; */

    // STEP 4. Sign the data with RSA-SHA1 to generate MAC code
    // ========================================================

    openssl_sign($data, $signature, $private_key, OPENSSL_ALGO_SHA1);

    $fields["VK_MAC"] = base64_encode($signature);

    // STEP 5. Generate POST form with payment data that will be sent to the bank
    // ==========================================================================
    ?>


    <form method="post" action="http://localhost:8080/banklink/ipizza">
        <!-- include all values as hidden form fields -->
        <?php foreach ($fields as $key => $val): ?>
            <input type="hidden" name="<?php echo $key; ?>" value="<?php echo htmlspecialchars($val); ?>"/>
        <?php endforeach; ?>

        <h1>Toetamine</h1>
        <!-- draw table output for demo -->

        <div class="row">

            Siin saate meie projekti toetada, et saaksime luua Teile parema rakenduse.


        </div>
        <div class="row">


            <input type="submit" id="toetameid" class="toetanupp" value="TOETA"/>

        </div>
    </form>


</div>
<script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
<script>window.jQuery || document.write('<script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js">\x3C/script>')</script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<script>window.jQuery || document.write('<script src="https://cdnjs.cloudflare.com/ajax/libs/respond.js/1.4.2/respond.min.js">\x3C/script>')</script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.0.0-beta1/jquery.min.js">\x3C/script>')</script>
<script src="js/demo.js"></script>
<script src="js/interactiveinfo.js"></script>
<script src="js/loadafterusers.js"></script>

</body>
</html>
